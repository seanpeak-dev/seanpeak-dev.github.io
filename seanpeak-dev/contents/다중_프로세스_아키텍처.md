---
date: '2021-11-02'
title: '다중 프로세스 아키텍처'
categories: ['브라우저']
summary: '크롬의 다중 프로세스 아키텍처를 바탕으로 브라우저 시스템을 살펴본다.'
---
## 브라우저가 실행되는 시스템적인 환경
- CPU 코어 하나가 작업을 하나씩 순서대로 처리, 모든 작업
- GPU 코어 여러 개가 작업을 동시에 처리, 그래픽 작업(빠른 렌더링과 매끄러운 상호작용)만
- CPU가 아닌 장치를 통해 작업 속도를 높이는 것을 '하드웨어 가속(hardware accelerated)'이라고 부른다. 브라우저에서의 하드웨어 가속은 주로 GPU를 이용한 그래픽 작업의 가속을 의미한다.

- 프로세스는 애플리케이션이 실행하는 프로그램, 애플리케이션을 시작하면 프로세스가 하나 생성되고, 운영체제는 프로세스가 작업할 메모리를 한 조각 준다. 애플리케이션을 종료하면 프로세스가 사라지고, 운영체제가 메모리를 비운다.
- 스레드는 프로세스 내부에 있으면서 프로세스로 실행되는 프로그램의 일부를 실행한다.
- 여러 작업을 수행하기 위해 프로세스는 운영체제에 다른 프로세스를 실행하라고 요청할 수도 있다. 그러면 메모리의 다른 부분이 새 프로세스에 할당된다.
- 두 프로세스가 서로 정보를 공유해야 할 때는 IPC(inter process communication, 프로세스 간 통신)를 사용한다.

## 브라우저 아키텍처
- 브라우저마다 스레드를 많이 사용하는 프로세스 하나만 사용하던지, 스레드를 조금만 사용하는 프로세스를 여러 개 만들어 IPC로 통신하던지 브라우저마다 접근 방식이 완전히 다를 수 있다.
- 크롬의 경우는 탭마다 프로세스를 할당하다가 이제는 사이트(iframe에 있는 사이트 포함)마다 프로세스를 할당한다.('process per tab' -> 'process per site')

### 크롬의 다중 프로세스 아키텍처
- 브라우저 프로세스 : 브라우저의 UI 영역, 눈에 보이지 않는 네트워크 요청이나 파일 권한 등 권한이 필요한 부분도 처리한다.
- 렌더러 프로세스 : 탭 안에서 웹 사이트가 표시되는 부분의 모든 것을 제어한다.
- 플러그인 프로세스 : 웹 사이트에서 사용하는 플러그인
- GPU 프로세스 : GPU 작업은 다른 프로세스와 격리해서 처리한다.
- 이외에도 더 많은 프로세스가 있으며, 크롬에서 실행 중인 프로세스를 확인하려면 '도구 더보기 > 작업 관리자'에 들어가보면 된다.

- 다중 프로세스는 메모리를 많이 잡아 먹는다는 단점은 있지만 오류에 대한 안정성이 증가하고, 빠른 사용자 경험을 제공하며, 사이트 격리에 따른 높은 보안성을 제공한다.
- 성능이 좋은 하드웨어에서 Chrome이 실행 중일 때에는 각 서비스를 여러 프로세스로 분할해 안정성을 높이고, 리소스가 제한적인 장치에서 실행 중일 때에는 서비스를 하나의 프로세스에서 실행해서 메모리 사용량을 줄이는 것이 기본 아이디어이다.

- iframe의 사이트의 경우 이전에는 같은 렌더러 프로세스에서 작동하였기 때문에 서로 다른 사이트 간에 메모리가 공유될 수 있다는 문제가 있어 지속적으로 논의가 있었다.
- [동일 출처 정책(same origin policy)](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)에 따라 한 사이트는 동의 없이 다른 사이트의 데이터에 접근할 수 없어야 한다.